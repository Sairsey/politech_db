{% extends 'base.html' %}

{% block body %}

<script>
  id = '{{ id }}';
  type = '{{ type }}';
  load_str = "/db_tools/profile_data&&&" + id + "|" + type;
  data = my_post_request(load_str);
  //document.getElementById("data_field").innerText = data;
  data = JSON.parse(data);
  headd = document.createElement("h1");
  if (type == "staff")
    headd.innerText = "Staff";
  else if (type == "project")
    headd.innerText = "Project";
  headd.innerText += " page";
  document.getElementById("content").appendChild(headd);
  fields = [];
  if (type == "staff")
    fields = ["Id", "Name", "Surname", "Email", "Position", "Is Fired"];
  else if (type == "project")
    fields = ["Id", "Name", "Time_start", "Time_end"];

  for (i = 0; i < fields.length; i++)
  {
    p = document.createElement("p");
    p.innerText = fields[i] + " : " + data["main"][0][i];
    document.getElementById("content").appendChild(p);
  }

  headd = document.createElement("h1");
  if (type == "staff")
    headd.innerText = "Projects";
  else if (type == "project")
    headd.innerText = "Staff";
  document.getElementById("content").appendChild(headd);

  if (type == "project")
    fields = ["", "", ""];
  else if (type == "staff")
    fields = ["", ""];

  list = document.createElement("ul");
  for (i = 0; i < data["childs"].length; i++)
  {
    el = document.createElement("li");
    if (data["active"][i] == 0)
      el.innerText += "\u274C";
    else
      el.innerText += "\u2705";
    for (j = 0; j < fields.length; j++)
    {
      if (type == "project" && j == fields.length - 1)
      {
        if (data["childs"][i][0][j] == 1)
          el.innerText += 'Fired';
        else
          el.innerText += 'Working';
      }
      else
        el.innerText += fields[j] + " " + data["childs"][i][0][j] + " ";
    }

    list.appendChild(el);
  }
  document.getElementById("content").appendChild(list);
</script>


{% endblock%}
